# 因果判断的统计方法

## 1 引言

探求事物之间的因果关系是哲学、自然科学和社会科学等众多研究所追求的终极目标。古希腊哲学家德谟克利特（约公元前400年）认为：发现一个因果关系胜过做国王。培根（1561--1626年）提出"知识就是力量"，并认为"真正的知识是根据因果关系得到的知识"。探索并发现因果关系及其方法论的研究，伴随人类社会的发展而不断精深，成为经久不衰的挑战。如何根据观测和试验探究事物之间的因果关系，这个问题自东西方古代哲学到现代科学，已经困惑了人类数千年。因果关系与相关关系是两个不同的概念。即使两个变量有相关关系也可能没有因果关系；相反地，它们没有相关关系也可能有因果关系。十九世纪末，统计学家提出了各种相关关系的形式化度量，最具有代表性的是Pearson相关系数。一个多世纪以来，统计学中关于相关关系的研究取得了令人瞩目的成就，而关于因果关系的研究则进展缓慢。正如Holland(1986)指出的那样：涉及因果推断的问题自始就缠住了统计学前进的步伐。2011年图灵奖获得者Pearl(2009)认为：在过去的一个世纪中，许多科学发现被推迟是由于缺少描述因果的数学语言。近年来，探索因果关系的研究越来越激励着统计学者和计算机学者， 在统计领域中对因果推断的兴趣正在复兴(Lauritzen,2004)。2008年以来，在国际机器学习会议和期刊中组织了多次因果挑战的Workshops(Guyon et al.,2008)和专题论文(Spirtes,2010)。在大数据时代，不仅要紧盯事物之间的相关关系，更应该挖掘蕴藏在大数据中的因果关系(DARPA, Big Mechanism Program) 例如，某超市发现顾客买尿布与买啤酒有很大的相关性，实际上二者没有因果关系，而出现这个相关性的原因是在家照顾婴儿的主妇常让丈夫去超市买尿布，这些丈夫买尿布的同时会顺便买啤酒。如果这些主妇改为自己在网上买尿布的话，将不能期望她们的丈夫同时会买啤酒。

在科学研究的各个领域都存在因果推断的挑战问题。在经济学中，诺贝尔经济学奖获得者Heckman(2008)提出了政策评价中的三个因果推断的挑战问题：
-   评价历史上出现的干预对结果的影响；
-   预测在一个环境中曾执行过的干预在其他环境中的影响；
-   预测历史上从没有经历过的干预在各种环境中的影响。
从时间序列预测的角度，Granger(1969)中提出了因果关系的定义：如果利用$X$能更好地预测$Y$，那么$X$是$Y$的原因。这个定义不能描述真正的因果关系，实际上是相关关系。例如，看到闪电可以预测雷声，而闪电却不是雷声的真正原因。相关关系是"预测"的基础，而因果关系是"决策"的基础。

目前，因果推断采用的两个主要模型是 潜在结果模型(Neyman1923;Rubin,1974)和因果网络模型(Pearl,1988;2009b]。潜在结果模型给出了因果作用的数学定义。该模型主要用在原因和结果变量已知的前提下，定量评价原因变量对结果变量的因果作用。因果网络模型是描述数据产生机制和外部干预的形式化语言。因果网络是将贝叶斯网络加上外部干预，用来定义外部干预的因果作用和描述多个变量之间的因果关系。利用因果网络不仅能定量评价因果作用，还能定性确定混杂因素，用于从数据挖掘因果关系。

本文第2节介绍因果推断的潜在结果模型，因果作用的可识别性，和随机化试验；
第3节介绍观察性研究和混杂因素，以及混杂因素完全观测时的因果推断方法；
第4节介绍存在未观测的混杂因素时因果作用的估计方法；
第5节介绍替代指标悖论和确定替代指标的准则；
第6节介绍因果网络模型和结构学习的算法.
最后，在第7节我们展望因果推断在现代大数据研究中的前景.

# 潜在结果模型

## 潜在结果和因果作用的定义

两个变量 $X$ 和  $Y$的相关系数可以用 $X$ 和 $Y$ 的联合分布的函数表示.
例如，Pearson 相关系数表示为 $\rho(X,Y)=\sigma_{xy}/(\sigma_x\sigma_y)$,
其中，$\sigma_{xy}$ 是 $X,Y$ 的协方差，$\sigma_x,\sigma_y$ 分别是  $X,Y$
的标准差. 但是，如何形式化表示两个变量 $X$ 和 $Y$ 的因果作用的度量呢？
用观测变量 $X$ 和 $Y$ 的联合分布的函数怎么也不能清楚地定义因果作用.

统计学家利用潜在结果给出了因果作用的的形式化定义. 利用潜在结果模型，
[@neyman1923application] 针对试验性研究  (experimental studies)
给出了因果作用的数学定义， [@rubin1974estimating]
将这一定义推广到观察性研究  (observational studies).
潜在结果模型通常需要假定个体处理值稳定 (stable unit treatment value
assumption，SUTVA)：
个体$i$的潜在结果不受其他个体的处理的影响，并且对每个个体和每一种处理只有一个潜在结果，详细讨论见 [@rubin1980randomization].
考虑一个二值处理或暴露变量 (treatment/exposure)，$X=1$ 代表处理组，$0$
代表对照组. 在接受处理分配  $X=x$ 后的结果变量为  $Y_x$,
表示假如接受处理  $X=x$ 后的结果， 称为潜在结果 (potential outcome).
对每个个体，实际观察的结果变量$Y$可以用潜在结果$(Y_1,Y_0)$表示为 $Y=XY_1+(1-X)Y_0$.
SUTVA 假定意味着张三的病是否被治好不受李四是否吃药的影响.
这个假定在很多实际问题中不成立，例如，李四获奖，也许会影响其同事张三的工作积极性；
周围的朋友打不打流感预防针也许会影响自己得不得流感.
这个假定也许是潜在结果模型的重要缺陷之一.
目前有一些学者试图利用社会网络方法弥补这个缺陷 [@hudgens2008toward; @sobel2006randomized; @tchetgen2012causal; @liu2014large; @eckles2017design; @athey2017exact].

因果作用定义为相同个体的潜在结果的比较 [@neyman1923application; @rubin1974estimating; @rubin1978bayesian].
个体 $i$ 的因果作用  (individual Causal Effect, ICE) 定义为：
$${\rm ICE}(i) = Y_1(i) - Y_0(i).$$
